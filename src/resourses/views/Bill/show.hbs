
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body style="background-color: #f5f5f5;">
    <div class="userpage">
        <div class="userpage__sidebar">
            <div class="userpage__sidebar--brief">
                <img src="https://upload.wikimedia.org/wikipedia/vi/archive/1/1d/20210321120435%21N%C6%A1i_n%C3%A0y_c%C3%B3_anh_-_Single_Cover.jpg" alt="avatar">
                <div class="userpage__sidebar--brief_username">
                    <strong id="user_name"></strong>
                    <br>
                    <label><i class="fas fa-pen"></i> Sửa Hồ Sơ</label>
                </div>
            </div>
            <div class="userpage__sidebar--menu">
                <ul>
                    <li>
                        <p style="background-color: rgb(240, 240, 69);"><i class="far fa-user-circle"></i></p>
                        <a href="/logon/profile">Tài Khoản Của Tôi</a>
                    </li>
                     <li class="active_bg_white">
                        <p style="background-color: rgb(53, 157, 218);"><i class="fas fa-file-alt"></i></p> 
                        <a href="/Bill/show">Đơn Mua</a>
                    </li>
                     <li>
                        <p style="background-color: rgb(224, 62, 50);"><i class="fas fa-bell"></i></p>                      
                        Thông Báo
                    </li>
                     <li>
                        <p style="background-color: rgb(238, 48, 121);"><i class="fas fa-wallet"></i></p>                        
                        Ví Voucher
                    </li>
                </ul>
            </div>
        </div>
        <div class="userpage__bill">
            <div class="userpage__bill--title">
                <div class="userpage__bill--title_status active__borderbot">
                   <a href="#" class="status">Chờ thanh toán</a>
                </div>
                <div class="userpage__bill--title_status">
                     <a href="#" class="status">Chờ lấy hàng</a>
                </div>
                <div class="userpage__bill--title_status">
                    <a href="#" class="status">Đang giao</a>
                </div>
                <div class="userpage__bill--title_status">
                    <a href="#" class="status">Đã giao</a>
                </div>
                <div class="userpage__bill--title_status">
                    <a href="#" class="status">Đã hủy</a>
                </div>
            </div>
            <div class="userpage__bill--content bill_show">
                {{#each bill}}
                {{#if (status this.status "ctt")}}
                <div class="userpage__bill--content_products">
                        {{#each this.products}}
                        <div class="Bill_product">
                            <div class="Bill_product--image">
                                <img src="{{this.image}}" alt="#" width="100px" height="80px">
                            </div>
                             <div class="Bill_product--name">
                                <span>{{this.name}}</span>
                            </div>
                             <div class="Bill_product--soluong">
                                <span>x{{this.soluong}}</span>
                            </div>
                             <div class="Bill_product--dongia">
                                <p id="formatPrice">
                                {{this.dongia}}
                                </p>
                                <span>VNĐ</span>
                            </div>
                        </div>
                        {{/each}}
                        <div class="userpage__bill--content_products--total">
                            <span>Số tiền phải trả:</span>
                            <p id="formatPrice">
                             {{this.total}}
                            </p>
                            <span>VNĐ</span>
                        </div>
                        <div class="userpage__bill--content_products--button">
                            <a href="#"><button class="btn_nor">Xem chi tiết đơn hàng</button></a>
                            <button id="{{this._id}}" class="btn_nor bill_btndel">Hủy đơn hàng</button>
                        </div>
                </div>
                {{/if}}
                {{/each}}
            </div>
            <div class="userpage__bill--content">
                {{#each bill}}
                {{#if (status this.status "clh")}}
                <div class="userpage__bill--content_products">
                        {{#each this.products}}
                        <div class="Bill_product">
                            <div class="Bill_product--image">
                                <img src="{{this.image}}" alt="#" width="100px" height="80px">
                            </div>
                             <div class="Bill_product--name">
                                <span>{{this.name}}</span>
                            </div>
                             <div class="Bill_product--soluong">
                                <span>x{{this.soluong}}</span>
                            </div>
                             <div class="Bill_product--dongia">
                                <p id="formatPrice">
                                {{this.dongia}}
                                </p>
                                <span>VNĐ</span>
                            </div>
                        </div>
                        {{/each}}
                        <div class="userpage__bill--content_products--total">
                            <span>Số tiền phải trả:</span>
                            <p id="formatPrice">
                             {{this.total}}
                            </p>
                            <span>VNĐ</span>
                        </div>
                        <div class="userpage__bill--content_products--button">
                            <a href="#"><button class="btn_nor">Xem chi tiết đơn hàng</button></a>
                            <button id="{{this._id}}" class="btn_nor bill_btndel">Hủy đơn hàng</button>
                        </div>
                </div>
                {{/if}}
                {{/each}}
            </div>
            <div class="userpage__bill--content">
                {{#each bill}}
                {{#if (status this.status "danggiao")}}
                <div class="userpage__bill--content_products">
                        {{#each this.products}}
                        <div class="Bill_product">
                            <div class="Bill_product--image">
                                <img src="{{this.image}}" alt="#" width="100px" height="80px">
                            </div>
                             <div class="Bill_product--name">
                                <span>{{this.name}}</span>
                            </div>
                             <div class="Bill_product--soluong">
                                <span>x{{this.soluong}}</span>
                            </div>
                             <div class="Bill_product--dongia">
                                <p id="formatPrice">
                                {{this.dongia}}
                                </p>
                                <span>VNĐ</span>
                            </div>
                        </div>
                        {{/each}}
                        <div class="userpage__bill--content_products--total">
                            <span>Số tiền phải trả:</span>
                            <p id="formatPrice">
                             {{this.total}}
                            </p>
                            <span>VNĐ</span>
                        </div>
                        <div class="userpage__bill--content_products--button">
                            <a href="#"><button class="btn_nor">Xem chi tiết đơn hàng</button></a>
                            <button id="{{this._id}}" class="btn_nor bill_btndel">Hủy đơn hàng</button>
                        </div>
                </div>
                {{/if}}
                {{/each}}
            </div>
            <div class="userpage__bill--content">
                {{#each bill}}
                {{#if (status this.status "dagiao")}}
                <div class="userpage__bill--content_products">
                        {{#each this.products}}
                        <div class="Bill_product">
                            <div class="Bill_product--image">
                                <img src="{{this.image}}" alt="#" width="100px" height="80px">
                            </div>
                             <div class="Bill_product--name">
                                <span>{{this.name}}</span>
                            </div>
                             <div class="Bill_product--soluong">
                                <span>x{{this.soluong}}</span>
                            </div>
                             <div class="Bill_product--dongia">
                                <p id="formatPrice">
                                {{this.dongia}}
                                </p>
                                <span>VNĐ</span>
                            </div>
                        </div>
                        {{/each}}
                        <div class="userpage__bill--content_products--total">
                            <span>Số tiền phải trả:</span>
                            <p id="formatPrice">
                             {{this.total}}
                            </p>
                            <span>VNĐ</span>
                        </div>
                        <div class="userpage__bill--content_products--button">
                            <a href="#"><button class="btn_nor">Xem chi tiết đơn hàng</button></a>
                            <button id="{{this._id}}" class="btn_nor bill_btnrepurchase">Mua lại</button>
                        </div>
                </div>
                {{/if}}
                {{/each}}
            </div>
            <div class="userpage__bill--content">
                {{#each bill}}
                {{#if (status this.status "dh")}}
                <div class="userpage__bill--content_products">
                        {{#each this.products}}
                        <div class="Bill_product">
                            <div class="Bill_product--image">
                                <img src="{{this.image}}" alt="#" width="100px" height="80px">
                            </div>
                             <div class="Bill_product--name">
                                <span>{{this.name}}</span>
                            </div>
                             <div class="Bill_product--soluong">
                                <span>x{{this.soluong}}</span>
                            </div>
                             <div class="Bill_product--dongia">
                                <p id="formatPrice">
                                {{this.dongia}}
                                </p>
                                <span>VNĐ</span>
                            </div>
                        </div>
                        {{/each}}
                        <div class="userpage__bill--content_products--total">
                            <span>Số tiền phải trả:</span>
                            <p id="formatPrice">
                             {{this.total}}
                            </p>
                            <span>VNĐ</span>
                        </div>
                        <div class="userpage__bill--content_products--button">
                            <a href="#"><button class="btn_nor">Xem chi tiết đơn hàng</button></a>
                            <button id="{{this._id}}" class="btn_nor bill_btnrepurchase">Mua lại</button>
                        </div>
                </div>
                {{/if}}
                {{/each}}
            </div>
            <div id="confirmdel" class="confirmdel">
                <div class="confirmdel__ques">
                    <span>Bạn có chắn chắn muốn xóa mặt hàng này?</span>
                </div>
                <div class="confirmdel__btn">
                    <button id="Cbtndestroy" class="btn--del">Xóa Bỏ</button>
                    <button id="Cbtnclose" class="btn--close">Hủy</button>
                </div>
            </div>
            <div id="bgblack" class="bg--black"></div>
            <form id="bill-form-delete"  method="POST"></form>
        </div>
    </div>
    
</body>
<script>
const user_name = sessionStorage.getItem("user_name");
document.getElementById("user_name").innerHTML = user_name;

const Link = document.querySelectorAll(".userpage__bill--title_status")
const products = document.querySelectorAll(".userpage__bill--content")

Link.forEach((item, index) => {

    const product = products[index]

    item.onclick = function() {


        const activeItem = document.querySelector(".userpage__bill--title_status.active__borderbot")
        const hiddenProduct = document.querySelector(".userpage__bill--content.bill_show")

        hiddenProduct.classList.remove('bill_show')
        product.classList.add('bill_show')

        activeItem.classList.remove('active__borderbot')
        this.classList.add('active__borderbot')

    }
})
// comfirmdel
const bg = document.getElementById("bgblack");
const confirmdel = document.getElementById("confirmdel");
const btndel = document.querySelectorAll(".bill_btndel");
const btnrepurchase = document.querySelectorAll(".bill_btnrepurchase");
const btnclose = document.getElementById("Cbtnclose");
const btndestroy = document.getElementById("Cbtndestroy");
const formdel = document.getElementById("bill-form-delete");


btnclose.addEventListener("click", function() {
    confirmdel.style.display = "none"
    bg.style.display = "none"
})

btndel.forEach(function(item, index) {
    item.addEventListener("click", function() {
        bg.style.display = "block"
        confirmdel.style.display = "block"

        btndestroy.addEventListener("click", function() {
            formdel.action = "/Bill/del/" + item.id + "?_method=PUT"
            formdel.submit();
        })
    })
})
btnrepurchase.forEach(function(item, index) {
    item.addEventListener("click", function() {
        formdel.action = "/Bill/repurchase/" + item.id + "?_method=PUT"
        formdel.submit();
    })
})

</script>
</html>

